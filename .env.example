# MeshCentral Stack Environment Variables
# Copy this file to .env and update with your actual values
# DO NOT commit .env to version control

# ===========================================
# MeshCentral Configuration
# ===========================================
# Your domain name (required)
MESHCENTRAL_HOSTNAME=mesh.example.com

# Node environment
NODE_ENV=production

# Reverse proxy settings
REVERSE_PROXY=caddy
REVERSE_PROXY_TLS_PORT=443

# ===========================================
# MongoDB Configuration
# ===========================================
# MongoDB root credentials (used for admin tasks)
MONGO_ROOT_USERNAME=admin
MONGO_ROOT_PASSWORD=changeme_secure_root_password_here

# MongoDB database name
MONGO_DATABASE=meshcentral

# MeshCentral database user credentials
MESHCENTRAL_DB_USER=meshcentral
MESHCENTRAL_DB_PASSWORD=changeme_secure_db_password_here

# ===========================================
# Caddy Configuration
# ===========================================
# Email for Let's Encrypt certificates
ACME_EMAIL=admin@example.com

# Caddy port configuration (default: 80, 443)
CADDY_HTTP_PORT=80
CADDY_HTTPS_PORT=443
CADDY_ADMIN_PORT=2019

# Cloudflare API for DNS challenge
CLOUDFLARE_API_TOKEN=your_cloudflare_dns_api_token_here

# ===========================================
# Cloudflare Tunnel Configuration (Optional)
# ===========================================
# Only needed if using Cloudflare Tunnel
# Get your tunnel token from: https://one.dash.cloudflare.com/
CLOUDFLARE_TUNNEL_TOKEN=your_cloudflare_tunnel_token_here

# ===========================================
# CrowdSec Configuration (Optional)
# ===========================================
# CrowdSec container name (used by init script)
CROWDSEC_CONTAINER=meshcentral-crowdsec

# CrowdSec Local API URL (internal Docker network)
CROWDSEC_LAPI_URL=http://crowdsec:8080

# Name for the MeshCentral bouncer
CROWDSEC_BOUNCER_NAME=meshcentral

# ===========================================
# WAF (nginx + ModSecurity + OWASP CRS) Configuration
# ===========================================
# HTTP and HTTPS ports exposed by the WAF container (default: 80 and 443)
WAF_HTTP_PORT=80
WAF_HTTPS_PORT=443

# Backend URL: internal MeshCentral service address (container name + port)
WAF_BACKEND=http://meshcentral-app:4430

# ModSecurity engine mode:
#   DetectionOnly – log violations without blocking (safe for initial testing)
#   On            – actively block detected attacks (recommended for production)
# Note: also update SecRuleEngine in waf/modsecurity.conf to match.
WAF_MODSEC_RULE_ENGINE=DetectionOnly

# Proxy timeout for long-lived MeshCentral agent connections (default: 3600s)
WAF_PROXY_TIMEOUT=3600s

# TLS certificate paths inside the WAF container.
# To terminate TLS at the WAF, place your files in waf/ssl/ and uncomment the
# corresponding volume mounts in the waf service in docker-compose.yml.
# Override these paths only if you mount certificates at different locations.
WAF_SSL_CERT=/etc/nginx/ssl/cert.pem
WAF_SSL_CERT_KEY=/etc/nginx/ssl/key.pem

# ===========================================
# Security Notes
# ===========================================
# 1. Generate strong passwords using: openssl rand -base64 32
# 2. Never use default passwords in production
# 3. Keep this file secure with proper file permissions: chmod 600 .env
# 4. Add .env to .gitignore to prevent accidental commits
# 5. Regularly rotate credentials
# 6. Use different passwords for each service
# 7. Consider using Docker secrets or a secrets manager for production
